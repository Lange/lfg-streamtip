<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="components/paper-styles/paper-styles.html">
	<link rel="import" href="components/paper-button/paper-button.html">
	<style is="custom-style">
		paper-button {
			margin-top: 8px;
			margin-bottom: 0;
			display: block;
		}

		h4 {
			margin-bottom: 0;
		}

		.column {
			flex: 1;
		}

		.column > span {
			display: block;
		}

		.amount {
			font-weight: bold;
			font-size: 200%;
		}

		.username,
		.amount {
			overflow: hidden;
			text-overflow: ellipsis;
			max-width: 117px;
		}
	</style>
</head>
<body>
	<div style="display: flex; text-align: center">
		<div id="daily" class="column" style="margin-right: 4px;">
			<h4>DAY TOP</h4>
			<span class="amount">?</span>
			<span class="username">?</span>
			<paper-button nodecg-dialog="reset-daily" class="nodecg-configure" raised>Reset</paper-button>
		</div>

		<div id="monthly" class="column" style="margin-left: 4px;">
			<h4>MONTH TOP</h4>
			<span class="amount">?</span>
			<span class="username">?</span>
			<paper-button nodecg-dialog="reset-monthly" class="nodecg-configure" raised>Reset</paper-button>
		</div>
	</div>

	<script>
		(function () {
			var dayAmount = document.querySelector('#daily .amount');
			var dayUsername = document.querySelector('#daily .username');
			var monthAmount = document.querySelector('#monthly .amount');
			var monthUsername = document.querySelector('#monthly .username');

			nodecg.Replicant('tops')
					.on('change', function (oldVal, newVal) {
						if (!newVal) return;

						var dayamt = '$0';
						var dayusr = 'N/A';
						var monthamt = '$0';
						var monthusr = 'N/A';
						var dayTopTip = newVal.daily;
						var monthTopTip = newVal.monthly;

						if (dayTopTip && dayTopTip.cents > 0) {
							dayamt = dayTopTip.currencySymbol + dayTopTip.amount;
							dayusr = dayTopTip.username;
						}

						if (monthTopTip && monthTopTip.cents > 0) {
							monthamt = monthTopTip.currencySymbol + monthTopTip.amount;
							monthusr = monthTopTip.username;
						}

						dayAmount.innerHTML = dayamt;
						dayAmount.setAttribute('title', dayamt);
						dayUsername.innerHTML = dayusr;
						dayUsername.setAttribute('title', dayusr);

						monthAmount.innerHTML = monthamt;
						monthAmount.setAttribute('title', monthamt);
						monthUsername.innerHTML = monthusr;
						monthUsername.setAttribute('title', monthusr);
					});
		})();
	</script>

</body>
</html>
